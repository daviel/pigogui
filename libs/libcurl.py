import ffi
import array
import uctypes

from libs.ffishell import fopen, fclose, fwrite

libcurl = ffi.open("libcurl.so")


CURLOPTTYPE_LONG =          0
CURLOPTTYPE_OBJECTPOINT =   10000
CURLOPTTYPE_FUNCTIONPOINT = 20000
CURLOPTTYPE_OFF_T =         30000
CURLOPTTYPE_BLOB =          40000

CURLOPTTYPE_STRINGPOINT = CURLOPTTYPE_OBJECTPOINT
CURLOPTTYPE_SLISTPOINT = CURLOPTTYPE_OBJECTPOINT
CURLOPTTYPE_CBPOINT = CURLOPTTYPE_OBJECTPOINT
CURLOPTTYPE_VALUES = CURLOPTTYPE_LONG

CURLOPT_WRITEDATA = CURLOPTTYPE_CBPOINT + 1
CURLOPT_URL = CURLOPTTYPE_STRINGPOINT + 2
CURLOPT_PORT = CURLOPTTYPE_LONG + 3
CURLOPT_PROXY = CURLOPTTYPE_STRINGPOINT + 4
CURLOPT_USERPWD = CURLOPTTYPE_STRINGPOINT + 5
CURLOPT_PROXYUSERPWD = CURLOPTTYPE_STRINGPOINT + 6
CURLOPT_RANGE = CURLOPTTYPE_STRINGPOINT + 7
CURLOPT_READDATA = CURLOPTTYPE_CBPOINT + 9
CURLOPT_ERRORBUFFER = CURLOPTTYPE_OBJECTPOINT + 10
CURLOPT_WRITEFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 11
CURLOPT_READFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 12
CURLOPT_TIMEOUT = CURLOPTTYPE_LONG + 13
CURLOPT_INFILESIZE = CURLOPTTYPE_LONG + 14
CURLOPT_POSTFIELDS = CURLOPTTYPE_OBJECTPOINT + 15
CURLOPT_REFERER = CURLOPTTYPE_STRINGPOINT + 16
CURLOPT_FTPPORT = CURLOPTTYPE_STRINGPOINT + 17
CURLOPT_USERAGENT = CURLOPTTYPE_STRINGPOINT + 18
CURLOPT_LOW_SPEED_LIMIT = CURLOPTTYPE_LONG + 19
CURLOPT_LOW_SPEED_TIME = CURLOPTTYPE_LONG + 20
CURLOPT_RESUME_FROM = CURLOPTTYPE_LONG + 21
CURLOPT_COOKIE = CURLOPTTYPE_STRINGPOINT + 22
CURLOPT_HTTPHEADER = CURLOPTTYPE_SLISTPOINT + 23
CURLOPT_SSLCERT = CURLOPTTYPE_STRINGPOINT + 25
CURLOPT_KEYPASSWD = CURLOPTTYPE_STRINGPOINT + 26
CURLOPT_CRLF = CURLOPTTYPE_LONG + 27
CURLOPT_QUOTE = CURLOPTTYPE_SLISTPOINT + 28
CURLOPT_HEADERDATA = CURLOPTTYPE_CBPOINT + 29
CURLOPT_COOKIEFILE = CURLOPTTYPE_STRINGPOINT + 31
CURLOPT_SSLVERSION = CURLOPTTYPE_VALUES + 32
CURLOPT_TIMECONDITION = CURLOPTTYPE_VALUES + 33
CURLOPT_TIMEVALUE = CURLOPTTYPE_LONG + 34
CURLOPT_CUSTOMREQUEST = CURLOPTTYPE_STRINGPOINT + 36
CURLOPT_STDERR = CURLOPTTYPE_OBJECTPOINT + 37
CURLOPT_POSTQUOTE = CURLOPTTYPE_SLISTPOINT + 39
CURLOPT_OBSOLETE40 = CURLOPTTYPE_OBJECTPOINT + 40
CURLOPT_VERBOSE = CURLOPTTYPE_LONG + 41
CURLOPT_HEADER = CURLOPTTYPE_LONG + 42
CURLOPT_NOPROGRESS = CURLOPTTYPE_LONG + 43
CURLOPT_NOBODY = CURLOPTTYPE_LONG + 44
CURLOPT_FAILONERROR = CURLOPTTYPE_LONG + 45
CURLOPT_UPLOAD = CURLOPTTYPE_LONG + 46
CURLOPT_POST = CURLOPTTYPE_LONG + 47
CURLOPT_DIRLISTONLY = CURLOPTTYPE_LONG + 48
CURLOPT_APPEND = CURLOPTTYPE_LONG + 50
CURLOPT_NETRC = CURLOPTTYPE_VALUES + 51
CURLOPT_FOLLOWLOCATION = CURLOPTTYPE_LONG + 52
CURLOPT_TRANSFERTEXT = CURLOPTTYPE_LONG + 53
CURLOPT_XFERINFODATA = CURLOPTTYPE_CBPOINT + 57
CURLOPT_AUTOREFERER = CURLOPTTYPE_LONG + 58
CURLOPT_PROXYPORT = CURLOPTTYPE_LONG + 59
CURLOPT_POSTFIELDSIZE = CURLOPTTYPE_LONG + 60
CURLOPT_HTTPPROXYTUNNEL = CURLOPTTYPE_LONG + 61
CURLOPT_INTERFACE = CURLOPTTYPE_STRINGPOINT + 62
CURLOPT_KRBLEVEL = CURLOPTTYPE_STRINGPOINT + 63
CURLOPT_SSL_VERIFYPEER = CURLOPTTYPE_LONG + 64
CURLOPT_CAINFO = CURLOPTTYPE_STRINGPOINT + 65
CURLOPT_MAXREDIRS = CURLOPTTYPE_LONG + 68
CURLOPT_FILETIME = CURLOPTTYPE_LONG + 69
CURLOPT_TELNETOPTIONS = CURLOPTTYPE_SLISTPOINT + 70
CURLOPT_MAXCONNECTS = CURLOPTTYPE_LONG + 71
CURLOPT_OBSOLETE72 = CURLOPTTYPE_LONG + 72
CURLOPT_FRESH_CONNECT = CURLOPTTYPE_LONG + 74
CURLOPT_FORBID_REUSE = CURLOPTTYPE_LONG + 75
CURLOPT_CONNECTTIMEOUT = CURLOPTTYPE_LONG + 78
CURLOPT_HEADERFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 79
CURLOPT_HTTPGET = CURLOPTTYPE_LONG + 80
CURLOPT_SSL_VERIFYHOST = CURLOPTTYPE_LONG + 81
CURLOPT_COOKIEJAR = CURLOPTTYPE_STRINGPOINT + 82
CURLOPT_SSL_CIPHER_LIST = CURLOPTTYPE_STRINGPOINT + 83
CURLOPT_HTTP_VERSION = CURLOPTTYPE_VALUES + 84
CURLOPT_FTP_USE_EPSV = CURLOPTTYPE_LONG + 85
CURLOPT_SSLCERTTYPE = CURLOPTTYPE_STRINGPOINT + 86
CURLOPT_SSLKEY = CURLOPTTYPE_STRINGPOINT + 87
CURLOPT_SSLKEYTYPE = CURLOPTTYPE_STRINGPOINT + 88
CURLOPT_SSLENGINE = CURLOPTTYPE_STRINGPOINT + 89
CURLOPT_SSLENGINE_DEFAULT = CURLOPTTYPE_LONG + 90
CURLOPT_DNS_CACHE_TIMEOUT = CURLOPTTYPE_LONG + 92
CURLOPT_PREQUOTE = CURLOPTTYPE_SLISTPOINT + 93
CURLOPT_DEBUGFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 94
CURLOPT_DEBUGDATA = CURLOPTTYPE_CBPOINT + 95
CURLOPT_COOKIESESSION = CURLOPTTYPE_LONG + 96
CURLOPT_CAPATH = CURLOPTTYPE_STRINGPOINT + 97
CURLOPT_BUFFERSIZE = CURLOPTTYPE_LONG + 98
CURLOPT_NOSIGNAL = CURLOPTTYPE_LONG + 99
CURLOPT_SHARE = CURLOPTTYPE_OBJECTPOINT + 100
CURLOPT_PROXYTYPE = CURLOPTTYPE_VALUES + 101
CURLOPT_ACCEPT_ENCODING = CURLOPTTYPE_STRINGPOINT + 102
CURLOPT_PRIVATE = CURLOPTTYPE_OBJECTPOINT + 103
CURLOPT_HTTP200ALIASES = CURLOPTTYPE_SLISTPOINT + 104
CURLOPT_UNRESTRICTED_AUTH = CURLOPTTYPE_LONG + 105
CURLOPT_FTP_USE_EPRT = CURLOPTTYPE_LONG + 106
CURLOPT_HTTPAUTH = CURLOPTTYPE_VALUES + 107
CURLOPT_SSL_CTX_FUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 108
CURLOPT_SSL_CTX_DATA = CURLOPTTYPE_CBPOINT + 109
CURLOPT_FTP_CREATE_MISSING_DIRS = CURLOPTTYPE_LONG + 110
CURLOPT_PROXYAUTH = CURLOPTTYPE_VALUES + 111
CURLOPT_SERVER_RESPONSE_TIMEOUT = CURLOPTTYPE_LONG + 112
CURLOPT_IPRESOLVE = CURLOPTTYPE_VALUES + 113
CURLOPT_MAXFILESIZE = CURLOPTTYPE_LONG + 114
CURLOPT_INFILESIZE_LARGE = CURLOPTTYPE_OFF_T + 115
CURLOPT_RESUME_FROM_LARGE = CURLOPTTYPE_OFF_T + 116
CURLOPT_MAXFILESIZE_LARGE = CURLOPTTYPE_OFF_T + 117
CURLOPT_NETRC_FILE = CURLOPTTYPE_STRINGPOINT + 118
CURLOPT_USE_SSL = CURLOPTTYPE_VALUES + 119
CURLOPT_POSTFIELDSIZE_LARGE = CURLOPTTYPE_OFF_T + 120
CURLOPT_TCP_NODELAY = CURLOPTTYPE_LONG + 121
CURLOPT_FTPSSLAUTH = CURLOPTTYPE_VALUES + 129
CURLOPT_FTP_ACCOUNT = CURLOPTTYPE_STRINGPOINT + 134
CURLOPT_COOKIELIST = CURLOPTTYPE_STRINGPOINT + 135
CURLOPT_IGNORE_CONTENT_LENGTH = CURLOPTTYPE_LONG + 136
CURLOPT_FTP_SKIP_PASV_IP = CURLOPTTYPE_LONG + 137
CURLOPT_FTP_FILEMETHOD = CURLOPTTYPE_VALUES + 138
CURLOPT_LOCALPORT = CURLOPTTYPE_LONG + 139
CURLOPT_LOCALPORTRANGE = CURLOPTTYPE_LONG + 140
CURLOPT_CONNECT_ONLY = CURLOPTTYPE_LONG + 141
CURLOPT_MAX_SEND_SPEED_LARGE = CURLOPTTYPE_OFF_T + 145
CURLOPT_MAX_RECV_SPEED_LARGE = CURLOPTTYPE_OFF_T + 146
CURLOPT_FTP_ALTERNATIVE_TO_USER = CURLOPTTYPE_STRINGPOINT + 147
CURLOPT_SOCKOPTFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 148
CURLOPT_SOCKOPTDATA = CURLOPTTYPE_CBPOINT + 149
CURLOPT_SSL_SESSIONID_CACHE = CURLOPTTYPE_LONG + 150
CURLOPT_SSH_AUTH_TYPES = CURLOPTTYPE_VALUES + 151
CURLOPT_SSH_PUBLIC_KEYFILE = CURLOPTTYPE_STRINGPOINT + 152
CURLOPT_SSH_PRIVATE_KEYFILE = CURLOPTTYPE_STRINGPOINT + 153
CURLOPT_FTP_SSL_CCC = CURLOPTTYPE_LONG + 154
CURLOPT_TIMEOUT_MS = CURLOPTTYPE_LONG + 155
CURLOPT_CONNECTTIMEOUT_MS = CURLOPTTYPE_LONG + 156
CURLOPT_HTTP_TRANSFER_DECODING = CURLOPTTYPE_LONG + 157
CURLOPT_HTTP_CONTENT_DECODING = CURLOPTTYPE_LONG + 158
CURLOPT_NEW_FILE_PERMS = CURLOPTTYPE_LONG + 159
CURLOPT_NEW_DIRECTORY_PERMS = CURLOPTTYPE_LONG + 160
CURLOPT_POSTREDIR = CURLOPTTYPE_VALUES + 161
CURLOPT_SSH_HOST_PUBLIC_KEY_MD5 = CURLOPTTYPE_STRINGPOINT + 162
CURLOPT_OPENSOCKETFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 163
CURLOPT_OPENSOCKETDATA = CURLOPTTYPE_CBPOINT + 164
CURLOPT_COPYPOSTFIELDS = CURLOPTTYPE_OBJECTPOINT + 165
CURLOPT_PROXY_TRANSFER_MODE = CURLOPTTYPE_LONG + 166
CURLOPT_SEEKFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 167
CURLOPT_SEEKDATA = CURLOPTTYPE_CBPOINT + 168
CURLOPT_CRLFILE = CURLOPTTYPE_STRINGPOINT + 169
CURLOPT_ISSUERCERT = CURLOPTTYPE_STRINGPOINT + 170
CURLOPT_ADDRESS_SCOPE = CURLOPTTYPE_LONG + 171
CURLOPT_CERTINFO = CURLOPTTYPE_LONG + 172
CURLOPT_USERNAME = CURLOPTTYPE_STRINGPOINT + 173
CURLOPT_PASSWORD = CURLOPTTYPE_STRINGPOINT + 174
CURLOPT_PROXYUSERNAME = CURLOPTTYPE_STRINGPOINT + 175
CURLOPT_PROXYPASSWORD = CURLOPTTYPE_STRINGPOINT + 176
CURLOPT_NOPROXY = CURLOPTTYPE_STRINGPOINT + 177
CURLOPT_TFTP_BLKSIZE = CURLOPTTYPE_LONG + 178
CURLOPT_SOCKS5_GSSAPI_NEC = CURLOPTTYPE_LONG + 180
CURLOPT_SSH_KNOWNHOSTS = CURLOPTTYPE_STRINGPOINT + 183
CURLOPT_SSH_KEYFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 184
CURLOPT_SSH_KEYDATA = CURLOPTTYPE_CBPOINT + 185
CURLOPT_MAIL_FROM = CURLOPTTYPE_STRINGPOINT + 186
CURLOPT_MAIL_RCPT = CURLOPTTYPE_SLISTPOINT + 187
CURLOPT_FTP_USE_PRET = CURLOPTTYPE_LONG + 188
CURLOPT_RTSP_REQUEST = CURLOPTTYPE_VALUES + 189
CURLOPT_RTSP_SESSION_ID = CURLOPTTYPE_STRINGPOINT + 190
CURLOPT_RTSP_STREAM_URI = CURLOPTTYPE_STRINGPOINT + 191
CURLOPT_RTSP_TRANSPORT = CURLOPTTYPE_STRINGPOINT + 192
CURLOPT_RTSP_CLIENT_CSEQ = CURLOPTTYPE_LONG + 193
CURLOPT_RTSP_SERVER_CSEQ = CURLOPTTYPE_LONG + 194
CURLOPT_INTERLEAVEDATA = CURLOPTTYPE_CBPOINT + 195
CURLOPT_INTERLEAVEFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 196
CURLOPT_WILDCARDMATCH = CURLOPTTYPE_LONG + 197
CURLOPT_CHUNK_BGN_FUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 198
CURLOPT_CHUNK_END_FUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 199
CURLOPT_FNMATCH_FUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 200
CURLOPT_CHUNK_DATA = CURLOPTTYPE_CBPOINT + 201
CURLOPT_FNMATCH_DATA = CURLOPTTYPE_CBPOINT + 202
CURLOPT_RESOLVE = CURLOPTTYPE_SLISTPOINT + 203
CURLOPT_TLSAUTH_USERNAME = CURLOPTTYPE_STRINGPOINT + 204
CURLOPT_TLSAUTH_PASSWORD = CURLOPTTYPE_STRINGPOINT + 205
CURLOPT_TLSAUTH_TYPE = CURLOPTTYPE_STRINGPOINT + 206
CURLOPT_TRANSFER_ENCODING = CURLOPTTYPE_LONG + 207
CURLOPT_CLOSESOCKETFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 208
CURLOPT_CLOSESOCKETDATA = CURLOPTTYPE_CBPOINT + 209
CURLOPT_GSSAPI_DELEGATION = CURLOPTTYPE_VALUES + 210
CURLOPT_DNS_SERVERS = CURLOPTTYPE_STRINGPOINT + 211
CURLOPT_ACCEPTTIMEOUT_MS = CURLOPTTYPE_LONG + 212
CURLOPT_TCP_KEEPALIVE = CURLOPTTYPE_LONG + 213
CURLOPT_TCP_KEEPIDLE = CURLOPTTYPE_LONG + 214
CURLOPT_TCP_KEEPINTVL = CURLOPTTYPE_LONG + 215
CURLOPT_SSL_OPTIONS = CURLOPTTYPE_VALUES + 216
CURLOPT_MAIL_AUTH = CURLOPTTYPE_STRINGPOINT + 217
CURLOPT_SASL_IR = CURLOPTTYPE_LONG + 218
CURLOPT_XFERINFOFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 219
CURLOPT_XOAUTH2_BEARER = CURLOPTTYPE_STRINGPOINT + 220
CURLOPT_DNS_INTERFACE = CURLOPTTYPE_STRINGPOINT + 221
CURLOPT_DNS_LOCAL_IP4 = CURLOPTTYPE_STRINGPOINT + 222
CURLOPT_DNS_LOCAL_IP6 = CURLOPTTYPE_STRINGPOINT + 223
CURLOPT_LOGIN_OPTIONS = CURLOPTTYPE_STRINGPOINT + 224
CURLOPT_SSL_ENABLE_ALPN = CURLOPTTYPE_LONG + 226
CURLOPT_EXPECT_100_TIMEOUT_MS = CURLOPTTYPE_LONG + 227
CURLOPT_PROXYHEADER = CURLOPTTYPE_SLISTPOINT + 228
CURLOPT_HEADEROPT = CURLOPTTYPE_VALUES + 229
CURLOPT_PINNEDPUBLICKEY = CURLOPTTYPE_STRINGPOINT + 230
CURLOPT_UNIX_SOCKET_PATH = CURLOPTTYPE_STRINGPOINT + 231
CURLOPT_SSL_VERIFYSTATUS = CURLOPTTYPE_LONG + 232
CURLOPT_SSL_FALSESTART = CURLOPTTYPE_LONG + 233
CURLOPT_PATH_AS_IS = CURLOPTTYPE_LONG + 234
CURLOPT_PROXY_SERVICE_NAME = CURLOPTTYPE_STRINGPOINT + 235
CURLOPT_SERVICE_NAME = CURLOPTTYPE_STRINGPOINT + 236
CURLOPT_PIPEWAIT = CURLOPTTYPE_LONG + 237
CURLOPT_DEFAULT_PROTOCOL = CURLOPTTYPE_STRINGPOINT + 238
CURLOPT_STREAM_WEIGHT = CURLOPTTYPE_LONG + 239
CURLOPT_STREAM_DEPENDS = CURLOPTTYPE_OBJECTPOINT + 240
CURLOPT_STREAM_DEPENDS_E = CURLOPTTYPE_OBJECTPOINT + 241
CURLOPT_TFTP_NO_OPTIONS = CURLOPTTYPE_LONG + 242
CURLOPT_CONNECT_TO = CURLOPTTYPE_SLISTPOINT + 243
CURLOPT_TCP_FASTOPEN = CURLOPTTYPE_LONG + 244
CURLOPT_KEEP_SENDING_ON_ERROR = CURLOPTTYPE_LONG + 245
CURLOPT_PROXY_CAINFO = CURLOPTTYPE_STRINGPOINT + 246
CURLOPT_PROXY_CAPATH = CURLOPTTYPE_STRINGPOINT + 247
CURLOPT_PROXY_SSL_VERIFYPEER = CURLOPTTYPE_LONG + 248
CURLOPT_PROXY_SSL_VERIFYHOST = CURLOPTTYPE_LONG + 249
CURLOPT_PROXY_SSLVERSION = CURLOPTTYPE_VALUES + 250
CURLOPT_PROXY_TLSAUTH_USERNAME = CURLOPTTYPE_STRINGPOINT + 251
CURLOPT_PROXY_TLSAUTH_PASSWORD = CURLOPTTYPE_STRINGPOINT + 252
CURLOPT_PROXY_TLSAUTH_TYPE = CURLOPTTYPE_STRINGPOINT + 253
CURLOPT_PROXY_SSLCERT = CURLOPTTYPE_STRINGPOINT + 254
CURLOPT_PROXY_SSLCERTTYPE = CURLOPTTYPE_STRINGPOINT + 255
CURLOPT_PROXY_SSLKEY = CURLOPTTYPE_STRINGPOINT + 256
CURLOPT_PROXY_SSLKEYTYPE = CURLOPTTYPE_STRINGPOINT + 257
CURLOPT_PROXY_KEYPASSWD = CURLOPTTYPE_STRINGPOINT + 258
CURLOPT_PROXY_SSL_CIPHER_LIST = CURLOPTTYPE_STRINGPOINT + 259
CURLOPT_PROXY_CRLFILE = CURLOPTTYPE_STRINGPOINT + 260
CURLOPT_PROXY_SSL_OPTIONS = CURLOPTTYPE_LONG + 261
CURLOPT_PRE_PROXY = CURLOPTTYPE_STRINGPOINT + 262
CURLOPT_PROXY_PINNEDPUBLICKEY = CURLOPTTYPE_STRINGPOINT + 263
CURLOPT_ABSTRACT_UNIX_SOCKET = CURLOPTTYPE_STRINGPOINT + 264
CURLOPT_SUPPRESS_CONNECT_HEADERS = CURLOPTTYPE_LONG + 265
CURLOPT_REQUEST_TARGET = CURLOPTTYPE_STRINGPOINT + 266
CURLOPT_SOCKS5_AUTH = CURLOPTTYPE_LONG + 267
CURLOPT_SSH_COMPRESSION = CURLOPTTYPE_LONG + 268
CURLOPT_MIMEPOST = CURLOPTTYPE_OBJECTPOINT + 269
CURLOPT_TIMEVALUE_LARGE = CURLOPTTYPE_OFF_T + 270
CURLOPT_HAPPY_EYEBALLS_TIMEOUT_MS = CURLOPTTYPE_LONG + 271
CURLOPT_RESOLVER_START_FUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 272
CURLOPT_RESOLVER_START_DATA = CURLOPTTYPE_CBPOINT + 273
CURLOPT_HAPROXYPROTOCOL = CURLOPTTYPE_LONG + 274
CURLOPT_DNS_SHUFFLE_ADDRESSES = CURLOPTTYPE_LONG + 275
CURLOPT_TLS13_CIPHERS = CURLOPTTYPE_STRINGPOINT + 276
CURLOPT_PROXY_TLS13_CIPHERS = CURLOPTTYPE_STRINGPOINT + 277
CURLOPT_DISALLOW_USERNAME_IN_URL = CURLOPTTYPE_LONG + 278
CURLOPT_DOH_URL = CURLOPTTYPE_STRINGPOINT + 279
CURLOPT_UPLOAD_BUFFERSIZE = CURLOPTTYPE_LONG + 280
CURLOPT_UPKEEP_INTERVAL_MS = CURLOPTTYPE_LONG + 281
CURLOPT_CURLU = CURLOPTTYPE_OBJECTPOINT + 282
CURLOPT_TRAILERFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 283
CURLOPT_TRAILERDATA = CURLOPTTYPE_CBPOINT + 284
CURLOPT_HTTP09_ALLOWED = CURLOPTTYPE_LONG + 285
CURLOPT_ALTSVC_CTRL = CURLOPTTYPE_LONG + 286
CURLOPT_ALTSVC = CURLOPTTYPE_STRINGPOINT + 287
CURLOPT_MAXAGE_CONN = CURLOPTTYPE_LONG + 288
CURLOPT_SASL_AUTHZID = CURLOPTTYPE_STRINGPOINT + 289
CURLOPT_MAIL_RCPT_ALLLOWFAILS = CURLOPTTYPE_LONG + 290
CURLOPT_SSLCERT_BLOB = CURLOPTTYPE_BLOB + 291
CURLOPT_SSLKEY_BLOB = CURLOPTTYPE_BLOB + 292
CURLOPT_PROXY_SSLCERT_BLOB = CURLOPTTYPE_BLOB + 293
CURLOPT_PROXY_SSLKEY_BLOB = CURLOPTTYPE_BLOB + 294
CURLOPT_ISSUERCERT_BLOB = CURLOPTTYPE_BLOB + 295
CURLOPT_PROXY_ISSUERCERT = CURLOPTTYPE_STRINGPOINT + 296
CURLOPT_PROXY_ISSUERCERT_BLOB = CURLOPTTYPE_BLOB + 297
CURLOPT_SSL_EC_CURVES = CURLOPTTYPE_STRINGPOINT + 298
CURLOPT_HSTS_CTRL = CURLOPTTYPE_LONG + 299
CURLOPT_HSTS = CURLOPTTYPE_STRINGPOINT + 300
CURLOPT_HSTSREADFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 301
CURLOPT_HSTSREADDATA = CURLOPTTYPE_CBPOINT + 302
CURLOPT_HSTSWRITEFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 303
CURLOPT_HSTSWRITEDATA = CURLOPTTYPE_CBPOINT + 304
CURLOPT_AWS_SIGV4 = CURLOPTTYPE_STRINGPOINT + 305
CURLOPT_DOH_SSL_VERIFYPEER = CURLOPTTYPE_LONG + 306
CURLOPT_DOH_SSL_VERIFYHOST = CURLOPTTYPE_LONG + 307
CURLOPT_DOH_SSL_VERIFYSTATUS = CURLOPTTYPE_LONG + 308
CURLOPT_CAINFO_BLOB = CURLOPTTYPE_BLOB + 309
CURLOPT_PROXY_CAINFO_BLOB = CURLOPTTYPE_BLOB + 310
CURLOPT_SSH_HOST_PUBLIC_KEY_SHA256 = CURLOPTTYPE_STRINGPOINT + 311
CURLOPT_PREREQFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 312
CURLOPT_PREREQDATA = CURLOPTTYPE_CBPOINT + 313
CURLOPT_MAXLIFETIME_CONN = CURLOPTTYPE_LONG + 314
CURLOPT_MIME_OPTIONS = CURLOPTTYPE_LONG + 315
CURLOPT_SSH_HOSTKEYFUNCTION = CURLOPTTYPE_FUNCTIONPOINT + 316
CURLOPT_SSH_HOSTKEYDATA = CURLOPTTYPE_CBPOINT + 317
CURLOPT_PROTOCOLS_STR = CURLOPTTYPE_STRINGPOINT + 318
CURLOPT_REDIR_PROTOCOLS_STR = CURLOPTTYPE_STRINGPOINT + 319
CURLOPT_WS_OPTIONS = CURLOPTTYPE_LONG + 320
CURLOPT_CA_CACHE_TIMEOUT = CURLOPTTYPE_LONG + 321
CURLOPT_QUICK_EXIT = CURLOPTTYPE_LONG + 322

CURL_GLOBAL_SSL =  (1<<0)
CURL_GLOBAL_WIN32 =  (1<<1)
CURL_GLOBAL_ALL =  (CURL_GLOBAL_SSL|CURL_GLOBAL_WIN32)
CURL_GLOBAL_NOTHING =  0
CURL_GLOBAL_DEFAULT =  CURL_GLOBAL_ALL
CURL_GLOBAL_ACK_EINTR =  (1<<2)


CURLINFO_STRING   = 0x100000
CURLINFO_LONG     = 0x200000
CURLINFO_DOUBLE   = 0x300000
CURLINFO_SLIST    = 0x400000
CURLINFO_PTR      = 0x400000
CURLINFO_SOCKET   = 0x500000
CURLINFO_OFF_T    = 0x600000
CURLINFO_MASK     = 0x0fffff
CURLINFO_TYPEMASK = 0xf00000

CURLINFO_EFFECTIVE_URL    = CURLINFO_STRING + 1
CURLINFO_RESPONSE_CODE    = CURLINFO_LONG   + 2
CURLINFO_TOTAL_TIME       = CURLINFO_DOUBLE + 3
CURLINFO_NAMELOOKUP_TIME  = CURLINFO_DOUBLE + 4
CURLINFO_CONNECT_TIME     = CURLINFO_DOUBLE + 5
CURLINFO_PRETRANSFER_TIME = CURLINFO_DOUBLE + 6
CURLINFO_SIZE_UPLOAD_T    = CURLINFO_OFF_T  + 7
CURLINFO_SIZE_DOWNLOAD_T  = CURLINFO_OFF_T  + 8
CURLINFO_SPEED_DOWNLOAD_T = CURLINFO_OFF_T  + 9
CURLINFO_SPEED_UPLOAD_T   = CURLINFO_OFF_T  + 10
CURLINFO_HEADER_SIZE      = CURLINFO_LONG   + 11
CURLINFO_REQUEST_SIZE     = CURLINFO_LONG   + 12
CURLINFO_SSL_VERIFYRESULT = CURLINFO_LONG   + 13
CURLINFO_FILETIME         = CURLINFO_LONG   + 14
CURLINFO_FILETIME_T       = CURLINFO_OFF_T  + 14
CURLINFO_CONTENT_LENGTH_DOWNLOAD_T = CURLINFO_OFF_T  + 15
CURLINFO_CONTENT_LENGTH_UPLOAD_T   = CURLINFO_OFF_T  + 16
CURLINFO_STARTTRANSFER_TIME = CURLINFO_DOUBLE + 17
CURLINFO_CONTENT_TYPE     = CURLINFO_STRING + 18
CURLINFO_REDIRECT_TIME    = CURLINFO_DOUBLE + 19
CURLINFO_REDIRECT_COUNT   = CURLINFO_LONG   + 20
CURLINFO_PRIVATE          = CURLINFO_STRING + 21
CURLINFO_HTTP_CONNECTCODE = CURLINFO_LONG   + 22
CURLINFO_HTTPAUTH_AVAIL   = CURLINFO_LONG   + 23
CURLINFO_PROXYAUTH_AVAIL  = CURLINFO_LONG   + 24
CURLINFO_OS_ERRNO         = CURLINFO_LONG   + 25
CURLINFO_NUM_CONNECTS     = CURLINFO_LONG   + 26
CURLINFO_SSL_ENGINES      = CURLINFO_SLIST  + 27
CURLINFO_COOKIELIST       = CURLINFO_SLIST  + 28
CURLINFO_FTP_ENTRY_PATH   = CURLINFO_STRING + 30
CURLINFO_REDIRECT_URL     = CURLINFO_STRING + 31
CURLINFO_PRIMARY_IP       = CURLINFO_STRING + 32
CURLINFO_APPCONNECT_TIME  = CURLINFO_DOUBLE + 33
CURLINFO_CERTINFO         = CURLINFO_PTR    + 34
CURLINFO_CONDITION_UNMET  = CURLINFO_LONG   + 35
CURLINFO_RTSP_SESSION_ID  = CURLINFO_STRING + 36
CURLINFO_RTSP_CLIENT_CSEQ = CURLINFO_LONG   + 37
CURLINFO_RTSP_SERVER_CSEQ = CURLINFO_LONG   + 38
CURLINFO_RTSP_CSEQ_RECV   = CURLINFO_LONG   + 39
CURLINFO_PRIMARY_PORT     = CURLINFO_LONG   + 40
CURLINFO_LOCAL_IP         = CURLINFO_STRING + 41
CURLINFO_LOCAL_PORT       = CURLINFO_LONG   + 42
CURLINFO_ACTIVESOCKET     = CURLINFO_SOCKET + 44
CURLINFO_TLS_SSL_PTR      = CURLINFO_PTR    + 45
CURLINFO_HTTP_VERSION     = CURLINFO_LONG   + 46
CURLINFO_PROXY_SSL_VERIFYRESULT = CURLINFO_LONG + 47
CURLINFO_SCHEME           = CURLINFO_STRING + 49
CURLINFO_TOTAL_TIME_T     = CURLINFO_OFF_T + 50
CURLINFO_NAMELOOKUP_TIME_T = CURLINFO_OFF_T + 51
CURLINFO_CONNECT_TIME_T   = CURLINFO_OFF_T + 52
CURLINFO_PRETRANSFER_TIME_T = CURLINFO_OFF_T + 53
CURLINFO_STARTTRANSFER_TIME_T = CURLINFO_OFF_T + 54
CURLINFO_REDIRECT_TIME_T  = CURLINFO_OFF_T + 55
CURLINFO_APPCONNECT_TIME_T = CURLINFO_OFF_T + 56
CURLINFO_RETRY_AFTER      = CURLINFO_OFF_T + 57
CURLINFO_EFFECTIVE_METHOD = CURLINFO_STRING + 58
CURLINFO_PROXY_ERROR      = CURLINFO_LONG + 59
CURLINFO_REFERER          = CURLINFO_STRING + 60
CURLINFO_CAINFO           = CURLINFO_STRING + 61
CURLINFO_CAPATH           = CURLINFO_STRING + 62
CURLINFO_LASTONE          = 62



def write_data(ptr, size, nmemb, stream):
    #print(ptr, size, nmemb, stream)
    size = fwrite(ptr, size, nmemb, stream)
    return size

curl_global_init = libcurl.func("v", "curl_global_init", "i")
curl_easy_init = libcurl.func("p", "curl_easy_init", "")
curl_easy_setopt = libcurl.func("v", "curl_easy_setopt", "pip")
curl_easy_perform = libcurl.func("v", "curl_easy_perform", "p")
curl_easy_cleanup = libcurl.func("v", "curl_easy_cleanup", "i")
curl_global_cleanup = libcurl.func("v", "curl_global_cleanup", "")
curl_easy_getinfo = libcurl.func("v", "curl_easy_getinfo", "pip")


curl_multi_init = libcurl.func("p", "curl_multi_init", "")
curl_multi_add_handle = libcurl.func("v", "curl_multi_add_handle", "pp")
curl_multi_perform = libcurl.func("v", "curl_multi_perform", "pp")
curl_multi_cleanup = libcurl.func("v", "curl_multi_cleanup", "i")
curl_multi_remove_handle = libcurl.func("v", "curl_multi_remove_handle", "pp")
curl_multi_poll = libcurl.func("v", "curl_multi_poll", "ppiii")

write_callback = ffi.callback("i", write_data, "PiiP")
